<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register – Chrisco Thika Bible Trivia</title>
  <link rel="icon" type="image/png" href="https://www.pngfind.com/pngs/m/207-2075087_bible-quiz-logo-png-transparent-bible-quiz-png.png"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            gold:  { DEFAULT:'#C8962E', light:'#F0C060', dark:'#8B6914' },
            parch: { DEFAULT:'#FDF6E3', dark:'#F5E6C0' },
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .font-cinzel { font-family: 'Cinzel', serif; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-br from-amber-950 via-amber-900 to-stone-900 px-4 py-8">

  <div class="w-full max-w-md">

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-6 space-y-2">
          {% for cat, msg in messages %}
            <div class="px-4 py-3 rounded-xl text-sm font-medium
              {% if cat == 'error' %}bg-red-900/60 border border-red-600 text-red-200
              {% else %}bg-green-900/60 border border-green-600 text-green-200{% endif %}">
              {{ msg }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- Church branding -->
    <div class="text-center mb-7">
      <div class="inline-flex items-center justify-center w-24 h-24 rounded-full bg-white/10 border-2 border-amber-600/40 mb-3">
        <span class="text-4xl">✝</span>
      </div>
      <div class="flex flex-col items-center leading-none">
        <h1 class="font-cinzel text-4xl font-bold text-amber-100 tracking-widest drop-shadow">Chrisco</h1>
        <p class="font-cinzel text-lg font-semibold text-amber-400 tracking-[0.3em] mt-1">Thika</p>
      </div>
      <p class="text-amber-300 mt-2 text-sm">
        First time we're seeing <span class="font-semibold text-amber-200">{{ phone }}</span>
      </p>
    </div>

    <!-- Name card -->
    <div class="bg-parch rounded-2xl shadow-2xl p-6 sm:p-8 border border-amber-700/30">
      <h2 class="font-cinzel text-xl font-semibold text-amber-900 text-center mb-1">What's your name?</h2>
      <p class="text-stone-500 text-sm text-center mb-6">We'll use this on the leaderboard</p>

      <form method="POST" onsubmit="return validateName()">
        <label class="block text-sm font-semibold text-stone-700 mb-2">Your Name</label>
        <input type="text" name="name" id="name-input"
               placeholder="e.g. David of Bethlehem"
               class="w-full px-4 py-3 rounded-xl border-2 border-amber-200 focus:border-amber-500 focus:outline-none bg-white text-stone-800 text-lg placeholder-stone-300 transition"
               required autofocus maxlength="60"
               oninput="liveValidateName(this)"/>
        <p id="name-error" class="text-xs mt-1.5 text-red-600 hidden"></p>

        <button type="submit"
                class="mt-5 w-full bg-amber-800 hover:bg-amber-700 text-parch font-semibold py-3.5 rounded-xl transition shadow-md text-lg font-cinzel tracking-wide">
          Join the Trivia ✝
        </button>
      </form>
    </div>

    <p class="text-center mt-4">
      <a href="{{ url_for('index') }}" class="text-amber-500/70 hover:text-amber-300 text-sm underline">← Change phone number</a>
    </p>
  </div>

  <script>
    function liveValidateName(input) {
      const val = input.value.trim();
      const err = document.getElementById('name-error');
      if (val.length > 0 && val.length < 2) {
        err.textContent = 'Name must be at least 2 characters.';
        err.classList.remove('hidden');
        input.classList.add('border-red-400');
        input.classList.remove('border-amber-200', 'border-green-400');
      } else if (val.length >= 2) {
        err.classList.add('hidden');
        input.classList.add('border-green-400');
        input.classList.remove('border-red-400', 'border-amber-200');
      } else {
        err.classList.add('hidden');
        input.classList.remove('border-red-400', 'border-green-400');
        input.classList.add('border-amber-200');
      }
    }

    function validateName() {
      const input = document.getElementById('name-input');
      if (input.value.trim().length < 2) {
        document.getElementById('name-error').textContent = 'Please enter your name (at least 2 characters).';
        document.getElementById('name-error').classList.remove('hidden');
        input.focus();
        return false;
      }
      return true;
    }
  </script>

</body>
</html>